import{a as ue,b as ce}from"./chunk-KQAEBY4X.js";import{a as me,b as pe}from"./chunk-QXYTI5FM.js";import"./chunk-N6O2YLUZ.js";import{a as ge}from"./chunk-LJQWLUAF.js";import{a as de,b as fe}from"./chunk-I2MVR3CV.js";import"./chunk-OVORNNTG.js";import{b as X,c as u,e as Z,f as $,i as ee,j as te,k as ie,l as re,m as oe,n as ne,o as le,p as ae,q as se}from"./chunk-KFXTHNAE.js";import"./chunk-7SMJ3EGY.js";import{b as J}from"./chunk-Q62EKAOT.js";import{i as K,j as Q}from"./chunk-SEIKCEHD.js";import"./chunk-4YXAR673.js";import"./chunk-4YRY4IP2.js";import"./chunk-Y6NU3EL2.js";import{V as E,Z as R}from"./chunk-JAK5WMHK.js";import"./chunk-ERJP7BH4.js";import"./chunk-EXZ2FE2D.js";import{Bc as Y,Cc as B,Db as v,Gb as F,Jb as G,Lb as q,Mb as A,Nb as i,Ob as r,Pb as p,Tb as y,Wb as g,Xb as b,_a as L,_b as W,db as d,eb as _,gc as l,hc as w,ia as P,ic as S,la as U,lc as C,mc as V,nc as k,oc as H,pb as j,pc as O,qc as N,ta as s,ua as m,va as h,vb as I,wa as x,zc as z}from"./chunk-MB7SRDLP.js";var T=class f{transform(n,e){if(!n||!Array.isArray(n))return[];if(!e||e.trim()==="")return n;let t=e.toLowerCase();return n.filter(o=>o.roomNumber?.toLowerCase().includes(t))}static \u0275fac=function(e){return new(e||f)};static \u0275pipe=U({name:"filterByRoomNumber",type:f,pure:!0,standalone:!0})};var be=()=>({width:"25rem"});function ve(f,n){if(f&1){let e=y();i(0,"div",11),p(1,"img",32),i(2,"div",33)(3,"h2",34),l(4),i(5,"span",35),l(6),r()(),i(7,"div",36)(8,"div"),l(9," \u{1F6CF}\uFE0F Capacity: "),i(10,"span",37),l(11),r()(),i(12,"div"),l(13," \u2705 Free: "),i(14,"span",38),l(15),r()(),i(16,"div"),l(17," \u274C Occupied: "),i(18,"span",39),l(19),r()()(),i(20,"div",40)(21,"span",41),l(22),r()(),i(23,"div",42)(24,"p-button",43),g("onClick",function(){let o=s(e).$implicit,c=b();return m(c.showUpdateDialog(o.roomId))}),r(),i(25,"p-button",44),g("onClick",function(o){let c=s(e).$implicit,a=b();return m(a.confirm2(o,"Do you want to delete this Room?","Room deleted","Delete","danger",0,c.roomId))}),r()()()()}if(f&2){let e=n.$implicit;d(),W("alt",e.roomNumber),v("src","http://housing-sys.runasp.net"+e.photoUrls[0],L),d(3),S(" ",e.roomNumber," "),d(2),S("#",e.roomId,""),d(5),w(e.capacity),d(4),w(e.freeSpaces),d(4),w(e.occupiedSpaces),d(3),S("\u{1F4B0} ",e.price," EGP")}}function ye(f,n){if(f&1){let e=y();i(0,"button",45),g("click",function(){s(e);let o=b();return m(o.visiblecreateform=!1)})("click",function(){s(e);let o=b();return m(o.createroomform.reset())}),h(),i(1,"svg",46),p(2,"path",47),r(),x(),i(3,"span",48),l(4,"Cancel"),r()(),i(5,"button",49),g("click",function(){s(e);let o=b();return m(o.visiblecreateform=!1)})("click",function(){s(e);let o=b();return m(o.onSubmit())}),h(),i(6,"svg",50),p(7,"path",51),r(),x(),i(8,"span",48),l(9,"Save"),r()()}}function we(f,n){if(f&1){let e=y();i(0,"button",45),g("click",function(){s(e);let o=b();return m(o.UpdateVisable=!1)})("click",function(){s(e);let o=b();return m(o.updateroomform.reset())}),h(),i(1,"svg",46),p(2,"path",47),r(),x(),i(3,"span",48),l(4,"Cancel"),r()(),i(5,"button",49),g("click",function(){s(e);let o=b();return m(o.UpdateVisable=!1)})("click",function(){s(e);let o=b();return m(o.onUpdateSubmit())}),h(),i(6,"svg",50),p(7,"path",51),r(),x(),i(8,"span",48),l(9,"Save"),r()()}}var he=class f{constructor(n,e,t,o,c){this.BuildsListService=n;this.ToastService=e;this.fb=t;this.confirmationService=o;this.messageService=c;this.createroomform=this.fb.group({roomNumber:["",u.required],capacity:[null,[u.required,u.min(1)]],price:[null,[u.required,u.min(0)]],buildingId:[null,u.required],photos:[[]]}),this.updateroomform=this.fb.group({roomId:[0,[u.required,u.min(1)]],roomNumber:["",u.required],capacity:[0,[u.required,u.min(1)]],price:[0,[u.required,u.min(0)]],buildingId:[0,[u.required,u.min(1)]],photos:[[],[u.required]]})}UpdateVisable=!1;updateroomform;selectedPhotos=[];selectedFiles=[];createroomform;images=j([]);position="bottom";showIndicatorsOnItem=!1;positionOptions=[{label:"Bottom",value:"bottom"}];filterText="";rooms=[];ngOnInit(){this.BuildsListService.GetAllRooms().subscribe({next:n=>{this.rooms=n.data,this.images.set(n.photoUrls)}})}showUpdateDialog(n){let e=this.rooms.filter(t=>t.roomId===n);this.updateroomform.patchValue({roomId:e[0].roomId,roomNumber:e[0].roomNumber,capacity:e[0].capacity,price:e[0].price,buildingId:e[0].buildingId,photos:[[]]}),this.UpdateVisable=!0}get U(){return this.updateroomform.controls}onUpdateSubmit(){if(this.updateroomform.valid){let n=new FormData,e=this.updateroomform.value;for(let t in e)n.append(t,e[t]);this.selectedPhotos.forEach(t=>{n.append("photos",t)}),this.selectedPhotos.length<=0?this.UpdateVisable=!1:this.BuildsListService.updateRoom(n).subscribe({next:t=>{let o=this.rooms.findIndex(c=>c.roomId===t.data.id);o!==-1&&(this.rooms.splice(o,1),this.rooms.push(t.data),this.ToastService.success("update refgister period",t.message),this.UpdateVisable=!1)},error:t=>console.error("Update failed",t)})}else this.updateroomform.markAllAsTouched(),this.UpdateVisable=!0}onPhotoSelected(n){let e=n.target.files;this.selectedPhotos=Array.from(e)}onFileChange(n){let t=n.target.files;t&&(this.selectedFiles=Array.from(t))}visiblecreateform=!1;get f(){return this.createroomform.controls}showDialog(){this.visiblecreateform=!0}onSubmit(){if(this.createroomform.valid){console.log(this.createroomform);let n=new FormData;for(let e in this.createroomform.value)e=="photos"?this.selectedFiles.forEach(t=>n.append("photos",t)):n.append(e,this.createroomform.value[e]);this.selectedFiles.length<=0?this.visiblecreateform=!0:this.BuildsListService.CreateRoom(n).subscribe({next:e=>{this.rooms.push(e.data),this.ToastService.success("Room creation",e.message),this.visiblecreateform=!1}})}else this.createroomform.markAllAsTouched(),this.visiblecreateform=!0}confirm2(n,e,t,o,c,a,M){this.confirmationService.confirm({target:n.target,message:e,icon:"pi pi-info-circle",rejectButtonProps:{label:"Cancel",severity:"secondary",outlined:!0},acceptButtonProps:{label:o,severity:c},accept:()=>{a==0&&this.BuildsListService.DeleteRoom(M).subscribe({next:Se=>{let D=this.rooms.findIndex(xe=>xe.roomId===M);D!==-1&&this.rooms.splice(D,1),this.messageService.add({severity:"info",summary:"Confirmed",detail:t,life:3e3})}})},reject:()=>{this.messageService.add({severity:"error",summary:"Rejected",detail:"You have rejected",life:3e3})}})}static \u0275fac=function(e){return new(e||f)(_(ge),_(J),_(le),_(E),_(R))};static \u0275cmp=P({type:f,selectors:[["app-rooms"]],inputs:{images:[1,"images"]},outputs:{images:"imagesChange"},standalone:!0,features:[H([E,R]),O],decls:76,vars:16,consts:[["footer",""],[1,"flex","items-center","justify-between","mx-3"],[1,"relative","inline-flex","items-center","justify-center","px-6","py-3","overflow-hidden","text-black","transition-all","duration-300","shadow-lg","cursor-pointer","bg-gradient-to-r","from-indigo-600","to-purple-600","rounded-xl","hover:shadow-xl","group","hover:from-purple-600","hover:to-indigo-600","focus:outline-none","focus:ring-4","focus:ring-indigo-300",3,"click"],[1,"absolute","inset-0","w-full","h-full","transition","duration-300","ease-out","transform","translate-x-full","bg-white","group-hover:translate-x-0","opacity-10"],["fill","none","stroke","currentColor","stroke-width","2","viewBox","0 0 24 24",1,"w-5","h-5","mr-2","transition-transform","duration-300","transform","group-hover:rotate-90"],["stroke-linecap","round","stroke-linejoin","round","d","M12 4v16m8-8H4"],[1,"relative","z-10","text-sm","font-semibold","tracking-wide","uppercase"],[1,"p-4","space-y-6"],[1,"w-full","max-w-sm"],["type","text","placeholder","Search by room number...",1,"w-full","px-4","py-2","border","border-gray-300","rounded-xl","focus:outline-none","focus:ring-2","focus:ring-purple-500",3,"ngModelChange","ngModel"],[1,"grid","grid-cols-1","gap-6","md:grid-cols-2","lg:grid-cols-3"],[1,"overflow-hidden","transition","duration-300","transform","bg-white","shadow-xl","rounded-2xl","hover:scale-105"],[1,"flex","justify-center","card"],[3,"visibleChange","visible","modal"],[1,"relative","inline-block","pb-2","text-2xl","font-bold","text-center","text-gray-800","dark:text-white"],[1,"text-center","text-transparent","bg-gradient-to-r","from-blue-500","via-purple-500","to-pink-500","bg-clip-text"],[1,"absolute","bottom-0","left-0","w-full","h-1","rounded","bg-gradient-to-r","from-blue-500","via-purple-500","to-pink-500"],[1,"max-w-2xl","p-6","mx-auto","space-y-6","bg-white","shadow-lg","p-y-12","rounded-2xl"],["enctype","multipart/form-data",1,"max-w-2xl","p-8","mx-auto","space-y-6","bg-white","shadow-xl","dark:bg-gray-900","rounded-2xl","animate-fade-in",3,"ngSubmit","formGroup"],[1,"block","mb-1","font-semibold","text-gray-700","dark:text-gray-200"],["type","text","formControlName","roomNumber","placeholder"," 101A",1,"w-full","px-4","py-3","transition","duration-200","border","border-gray-300","rounded-xl","focus:outline-none","focus:ring-2","focus:ring-purple-500"],["type","number","formControlName","capacity","placeholder"," 3",1,"w-full","px-4","py-3","transition","duration-200","border","border-gray-300","rounded-xl","focus:outline-none","focus:ring-2","focus:ring-purple-500"],["type","number","formControlName","price","placeholder"," 150",1,"w-full","px-4","py-3","transition","duration-200","border","border-gray-300","rounded-xl","focus:outline-none","focus:ring-2","focus:ring-purple-500"],["type","number","formControlName","buildingId","placeholder"," 2",1,"w-full","px-4","py-3","transition","duration-200","border","border-gray-300","rounded-xl","focus:outline-none","focus:ring-2","focus:ring-purple-500"],["type","file","multiple","",1,"w-full","px-4","py-2","text-gray-700","bg-white","border","border-gray-300","cursor-pointer","rounded-xl","file:mr-4","file:py-2","file:px-4","file:rounded-lg","file:border-0","file:text-sm","file:font-semibold","file:bg-purple-100","file:text-purple-700","hover:file:bg-purple-200",3,"change"],["enctype","multipart/form-data",1,"space-y-6",3,"ngSubmit","formGroup"],[1,"block","mb-1","font-semibold","text-gray-700"],["type","text","formControlName","roomNumber","name","roomNumber","required","","placeholder",", 302A",1,"w-full","p-3","transition-all","border","border-gray-300","outline-none","rounded-xl","focus:ring-2","focus:ring-purple-500"],["name","capacity","type","number","formControlName","capacity","required","","placeholder",", 4",1,"w-full","p-3","transition-all","border","border-gray-300","outline-none","rounded-xl","focus:ring-2","focus:ring-purple-500"],["name","price","type","number","formControlName","price","required","","placeholder",", 150",1,"w-full","p-3","transition-all","border","border-gray-300","outline-none","rounded-xl","focus:ring-2","focus:ring-purple-500"],["name","buildingId","type","number","formControlName","buildingId","required","","placeholder",", 2",1,"w-full","p-3","transition-all","border","border-gray-300","outline-none","rounded-xl","focus:ring-2","focus:ring-purple-500"],["type","file","name","photos","multiple","",1,"w-full","p-3","text-gray-600","bg-white","border","border-gray-300","cursor-pointer","rounded-xl","file:bg-purple-100","file:text-purple-700","file:rounded-lg","file:px-4","file:py-2","hover:file:bg-purple-200",3,"change"],["loading","lazy",1,"object-cover","w-full","h-48",3,"src","alt"],[1,"p-4","space-y-3"],[1,"flex","items-center","justify-between","text-xl","font-bold","text-gray-800"],[1,"px-2","py-1","text-xs","text-white","bg-blue-500","rounded"],[1,"space-y-1","text-sm","text-gray-600"],[1,"font-semibold","text-gray-800"],[1,"font-semibold","text-green-600"],[1,"font-semibold","text-red-500"],[1,"flex","items-center","justify-between"],[1,"text-lg","font-semibold","text-purple-600"],[1,"flex","justify-around","w-full","gap-2","mt-4"],["label","Update","severity","info","styleClass","w-full","icon","pi pi-pencil",3,"onClick"],["label","Delete","severity","danger","styleClass","w-full","icon","pi pi-trash",3,"onClick"],[1,"inline-flex","items-center","justify-center","px-6","py-3","text-gray-700","transition","duration-200","ease-in-out","bg-gray-200","shadow-sm","cursor-pointer","hover:bg-gray-300","rounded-xl","focus:outline-none","focus:ring-2","focus:ring-gray-400",3,"click"],["fill","none","stroke","currentColor","stroke-width","2","viewBox","0 0 24 24",1,"w-5","h-5","mr-2","text-gray-600","transition-transform","duration-300","transform","group-hover:scale-110"],["stroke-linecap","round","stroke-linejoin","round","d","M6 18L18 6M6 6l12 12"],[1,"text-sm","font-semibold","tracking-wide","uppercase"],["type","submit",1,"relative","inline-flex","items-center","justify-center","px-6","py-3","text-white","transition","duration-300","ease-in-out","shadow-md","cursor-pointer","rounded-xl","hover:shadow-lg","group","focus:outline-none","focus:ring-4","focus:ring-blue-300",2,"background-color","#012a5b",3,"click"],["fill","none","stroke","currentColor","stroke-width","2","viewBox","0 0 24 24",1,"w-5","h-5","mr-2","transition-transform","duration-300","transform","group-hover:scale-110"],["stroke-linecap","round","stroke-linejoin","round","d","M5 13l4 4L19 7"]],template:function(e,t){if(e&1){let o=y();i(0,"section")(1,"div",1)(2,"button",2),g("click",function(){return s(o),m(t.showDialog())}),p(3,"span",3),h(),i(4,"svg",4),p(5,"path",5),r(),x(),i(6,"span",6),l(7," Create "),r()()(),i(8,"div",7)(9,"div",8)(10,"input",9),k("ngModelChange",function(a){return s(o),V(t.filterText,a)||(t.filterText=a),m(a)}),r()(),i(11,"div",10),q(12,ve,26,8,"div",11,G),z(14,"filterByRoomNumber"),r()()(),p(15,"p-confirmpopup")(16,"p-toast"),i(17,"div",12)(18,"p-dialog",13),k("visibleChange",function(a){return s(o),V(t.visiblecreateform,a)||(t.visiblecreateform=a),m(a)}),i(19,"h3",14)(20,"span",15),l(21," Fill the form to create room "),r(),p(22,"span",16),r(),i(23,"div",17)(24,"form",18),g("ngSubmit",function(){return s(o),m(t.onSubmit())}),i(25,"div")(26,"label",19),l(27,"Room Number"),r(),p(28,"input",20),r(),i(29,"div")(30,"label",19),l(31,"Capacity"),r(),p(32,"input",21),r(),i(33,"div")(34,"label",19),l(35,"Price ($)"),r(),p(36,"input",22),r(),i(37,"div")(38,"label",19),l(39,"Building ID"),r(),p(40,"input",23),r(),i(41,"div")(42,"label",19),l(43,"Photos"),r(),i(44,"input",24),g("change",function(a){return s(o),m(t.onFileChange(a))}),r()()()(),I(45,ye,10,0,"ng-template",null,0,B),r()(),i(47,"div",12)(48,"p-dialog",13),k("visibleChange",function(a){return s(o),V(t.UpdateVisable,a)||(t.UpdateVisable=a),m(a)}),i(49,"h3",14)(50,"span",15),l(51," Fill the form to Update Room "),r(),p(52,"span",16),r(),i(53,"form",25),g("ngSubmit",function(){return s(o),m(t.onUpdateSubmit())}),i(54,"div")(55,"label",26),l(56,"Room Number"),r(),p(57,"input",27),r(),i(58,"div")(59,"label",26),l(60,"Capacity"),r(),p(61,"input",28),r(),i(62,"div")(63,"label",26),l(64,"Price ($)"),r(),p(65,"input",29),r(),i(66,"div")(67,"label",26),l(68,"Building ID"),r(),p(69,"input",30),r(),i(70,"div")(71,"label",26),l(72,"Photos"),r(),i(73,"input",31),g("change",function(a){return s(o),m(t.onPhotoSelected(a))}),r()()(),I(74,we,10,0,"ng-template",null,0,B),r()()}e&2&&(d(10),C("ngModel",t.filterText),d(2),A(Y(14,11,t.rooms,t.filterText)),d(6),F(N(14,be)),C("visible",t.visiblecreateform),v("modal",!0),d(6),v("formGroup",t.createroomform),d(24),F(N(15,be)),C("visible",t.UpdateVisable),v("modal",!0),d(5),v("formGroup",t.updateroomform))},dependencies:[se,te,X,ie,Z,$,ne,re,oe,ae,ee,fe,de,T,Q,K,pe,me,ce,ue]})};export{he as RoomsComponent};
